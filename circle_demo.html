<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style type="text/css">
        
        #map {
           
            height: 500px;
            width: 500px;            
            border: 1px solid black;
        }
    </style>
</head>
<body>

<h1>Circle demo</h1>

<div id="map"></div>
<form autocomplete="off">
    <input type="checkbox" id="active" value="active"> Aktiv
</form>
<div id="result">Aktiver og klikk i kartet for å tegne en sirkel</div>

<script type="text/javascript" src="js/lib/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="js/lib/underscore-min.js"></script>
<script type="text/javascript" src="js/lib/backbone-min.js"></script>
<script type="text/javascript" src="js/lib/OpenLayers-2.13.1/OpenLayers.js"></script>
<script type="text/javascript" src="js/lib/proj4.js"></script>
<script type="text/javascript" src="js/src/mapcore.js"></script>
<script type="text/javascript" src="js/src/CircleDraw.js"></script>

<script type="text/javascript">
(function () {
    'use strict';

    proj4.defs(
        'EPSG:32633',
        '+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs'
    );

    var map = new BW.MapCore.MapConfig(
        'map',
        {
            initZoom: 0,
            baseLayers: [
                {id: 1, visible: true}
            ],   
            baseLayerList: [
                {
                    id: 1,
                    protocol: 'WMTS',
                    name: 'Hovedkart Sjø',
                    url: 'http://opencache.statkart.no/gatekeeper/gk/gk.open_wmts?',
                    layerName: 'sjo_hovedkart2'
                } 
            ]
        }
    );

    var circleControl = new BW.MapCore.CircleControl(
        map.map,
        function (res) {
            $('#result').html('Sirkel med ' + res.Distance + 'NM radius rundt (' + res.Lon + ', ' + res.Lat + ')');
        }/*,
        {
            Lon: -0.6971787128087309,
            Lat: 59.22474117265253,
            Distance: 1786.6
        } */
    );

    circleControl.show();

    $('#active').change(function () {
        if ($(this).is(":checked")) {
            console.log("activate!");
            circleControl.activate();
        } else {
            console.log("deactivate!");
            circleControl.deactivate();
            $('#result').html("");
        }
    });
    $('#active').attr("checked", false);

    //circleControl.activate();

}());
</script>

</body>
</html>
