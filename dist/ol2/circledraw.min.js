var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);

return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),
this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),
this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),
this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),
this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate();

}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0
},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10;

}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),
this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){
var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();

var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){
this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){
this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,
this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);var BW=this.BW||{};BW.MapCore=BW.MapCore||{},function(a){"use strict";function b(a){var b=1852;return Math.round(a/b*10)/10}function c(a){var b=1852;return a*b}function d(a){var b=proj4(proj4.defs["EPSG:32633"],proj4.defs["EPSG:4326"]).forward([a.x,a.y]);return{lon:b[0],lat:b[1]}}function e(a){var b=proj4(proj4.defs["EPSG:4326"],proj4.defs["EPSG:32633"]).forward([a.x,a.y]);return{x:b[0],y:b[1]}}function f(a){return a.geometry?a.geometry.CLASS_NAME.replace("OpenLayers.Geometry.",""):null}function g(a,b){if("Polygon"!==f(a))return!1;var c=new OpenLayers.Geometry.Point(b.lon,b.lat);return a.geometry.containsPoint(c)}var h={strokeColor:"#B80000",strokeWidth:2,fillOpacity:0},i={strokeColor:"#000000",strokeWidth:2,fillOpacity:0},j={strokeColor:"#B800FF",strokeWidth:10,fillOpacity:0,strokeOpacity:0},k=OpenLayers.Class(OpenLayers.Control.DragFeature,{moveFeature:function(a){this.nomove?this.events.triggerEvent("move",{xy:a}):OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},downFeature:function(a){"LineString"===f(this.feature)&&(this.nomove=!0,this.events.triggerEvent("down",{xy:a})),this.lastPixel=a,this.onStart(this.feature,a)},upFeature:function(a){if(this.nomove){this.outFeature(this.feature);var b,c,d,e=this.map.getLonLatFromPixel(a);for(b=0,c=this.layer.features.length;c>b;b++)if(d=this.layer.features[b],g(d,e),g(d,e)){this.overFeature(d);break}this.events.triggerEvent("up",{xy:a}),this.nomove=!1}this.over||this.handlers.drag.deactivate()}});a.CircleControl=function(a,b,c){this.map=a,this.active=!1,this.started=!1,this.callback=b,this.layer=new OpenLayers.Layer.Vector,this.dragControl=new k(this.layer,{onComplete:_.bind(this.circleModified,this)}),this.dragControl.events.on({down:_.bind(this.startEditDraw,this),up:_.bind(this.stopDraw,this),move:_.bind(this.move,this),drag:_.bind(this.updateShadow,this)}),this.map.addControl(this.dragControl),c&&this.setInitData(c)},a.CircleControl.prototype.setInitData=function(a){this.centerPoint=e({x:a.Lon,y:a.Lat}),this.radius=c(a.Distance)},a.CircleControl.prototype.show=function(){this.centerPoint&&this.radius&&(this.map.addLayer(this.layer),this.drawRing(this.centerPoint,this.radius,i))},a.CircleControl.prototype.activate=function(){this.active||(this.active=!0,this.map.addLayer(this.layer),this.map.events.register("click",this,this.click),this.centerPoint&&this.radius&&(this.drawRing(this.centerPoint,this.radius),this.sendCallback(this.centerPoint,this.radius),this.dragControl.activate()))},a.CircleControl.prototype.removeLayer=function(){this.feature=null,this.layer&&(this.layer.removeAllFeatures(),this.layer.map&&this.map.removeLayer(this.layer))},a.CircleControl.prototype.deactivate=function(){this.active&&(this.active=!1,this.removeLayer(),this.map.events.unregister("click",this,this.click),this.dragControl.deactivate())},a.CircleControl.prototype.startEditDraw=function(a){this.point2=this.map.getLonLatFromPixel(a.xy);var b=this.feature.geometry.getCentroid(),c=b.x-this.point2.lon,d=b.y-this.point2.lat,e=new OpenLayers.Geometry.Point(b.x+c,b.y+d);this.point1=new OpenLayers.LonLat(e.x,e.y)},a.CircleControl.prototype.startDraw=function(a){this.map.events.register("mousemove",this,this.move),this.point1=this.map.getLonLatFromPixel(a.xy),this.point2=this.map.getLonLatFromPixel(a.xy),this.draw()},a.CircleControl.prototype.stopDraw=function(a){this.map.events.unregister("mousemove",this,this.move),this.point2=this.map.getLonLatFromPixel(a.xy),this.map.events.unregister("click",this,this.click),this.dragControl.activate();var b=this.p;b&&this.sendCallback(b.centerPoint,b.radius)},a.CircleControl.prototype.sendCallback=function(a,c){this.centerPoint=a,this.radius=c,a=d(a),this.callback({Lon:a.lon,Lat:a.lat,Distance:b(c)})},a.CircleControl.prototype.circleModified=function(){this.drawDragRing();var a=this.feature.geometry,b=a.getCentroid(),c=a.getBounds(),d=(c.right-c.left)/2,e=OpenLayers.Geometry.Polygon.createRegularPolygon(b,d,4).getBounds();this.point1=new OpenLayers.LonLat(e.left,e.top),this.sendCallback(b,d)},a.CircleControl.prototype.move=function(a){this.point2=this.map.getLonLatFromPixel(a.xy),this.p=this.draw()},a.CircleControl.prototype.draw=function(){if(this.point1&&this.point2){var a=Math.max(this.point1.lat,this.point2.lat),b=Math.min(this.point1.lat,this.point2.lat),c=Math.min(this.point1.lon,this.point2.lon),d=Math.max(this.point1.lon,this.point2.lon),e=Math.max(Math.abs(a-b),Math.abs(d-c));this.point1.lat<this.point2.lat?a=b+e:b=a-e,this.point1.lon<this.point2.lon?d=c+e:c=d-e;var f=new OpenLayers.Geometry.Point(c+(d-c)/2,b+(a-b)/2),g=Math.sqrt(Math.pow(e,2)+Math.pow(e,2))/2;return this.drawRing(f,g)}},a.CircleControl.prototype.drawRing=function(a,b,c){var d=c||h,e=OpenLayers.Geometry.Polygon.createRegularPolygon(a,b,30);return this.layer.removeAllFeatures(),this.feature=new OpenLayers.Feature.Vector(e,{},d),this.updateShadow(),this.layer.addFeatures([this.feature]),this.drawDragRing(),{centerPoint:a,radius:b}},a.CircleControl.prototype.drawDragRing=function(){this.dragRing&&this.layer.removeFeatures([this.dragRing]),this.dragRing=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(this.feature.geometry.components[0].components),{},j),this.layer.addFeatures([this.dragRing])},a.CircleControl.prototype.click=function(a){this.started=!this.started,this.started?this.startDraw(a):this.stopDraw(a)},a.CircleControl.prototype.updateShadow=function(){}}(BW.MapCore);